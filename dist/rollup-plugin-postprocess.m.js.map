{"version":3,"file":"rollup-plugin-postprocess.m.js","sources":["../postprocess.js"],"sourcesContent":["import MagicString from 'magic-string';\n\nlet currentToken;\nconst replacer = (str, index) => currentToken[index];\n\nexport default function postprocess(allReplacements) {\n\treturn {\n\t\tname: 'postprocess',\n\t\trenderChunk(code, { sourceMap, format }) {\n\t\t\tlet str = new MagicString(code);\n\t\t\tlet replacements = typeof allReplacements==='function' ? allReplacements({ code, sourceMap, format }) : allReplacements;\n\n\t\t\tfor (let i=0; i<replacements.length; i++) {\n\t\t\t\tlet [find, replace=''] = replacements[i];\n\t\t\t\tif (typeof find==='string') find = new RegExp(find);\n\t\t\t\tif (!find.global) {\n\t\t\t\t\tfind = new RegExp(find.source, 'g' + String(find).split('/').pop());\n\t\t\t\t}\n\n\t\t\t\tlet token;\n\t\t\t\twhile (token=find.exec(code)) {\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (typeof replace==='function') {\n\t\t\t\t\t\tvalue = replace.apply(null, token);\n\t\t\t\t\t\tif (value==null) value = '';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcurrentToken = token;\n\t\t\t\t\t\tvalue = replace.replace(/\\$(\\d+)/, replacer);\n\t\t\t\t\t}\n\t\t\t\t\tstr.overwrite(token.index, token.index + token[0].length, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcode: str.toString(),\n\t\t\t\tmap: sourceMap===false ? null : str.generateMap({ hires: true })\n\t\t\t};\n\t\t}\n\t};\n}\n"],"names":["let","const"],"mappings":";;AAEAA,IAAI;AACJC,IAAM,qBAAY,GAAK,EAAA,OAAN,SAAgB,YAAA,CAAa;AAE9C,AAAe,SAAS,YAAY,iBAAiB;IACpD,OAAO;QACN,MAAM,aADA;QAEN,kCAAY,IAAM,EAAA,KAAuB;gBAArB;gBAAW;;YAC9BD,IAAI,MAAM,IAAI,WAAJ,CAAgB;YAC1BA,IAAI,eAAe,OAAO,eAAP,KAAyB,UAAzB,GAAsC,eAAA,CAAgB;sBAAE,IAAF;2BAAQ,SAAR;wBAAmB;iBAAY;YAExG,KAAKA,IAAI,IAAE,EAAG,CAAA,GAAE,YAAA,CAAa,QAAQ,CAAA,IAAK;gBACzC,YAAyB,YAAA,CAAa;oBAAjC;4EAAc;gBACnB,IAAI,OAAO,IAAP,KAAc;sBAAU,IAAA,GAAO,IAAI,MAAJ,CAAW;gBAC9C,IAAI,CAAC,IAAA,CAAK,QAAQ;oBACjB,IAAA,GAAO,IAAI,MAAJ,CAAW,IAAA,CAAK,QAAQ,GAAA,GAAM,MAAA,CAAO,KAAP,CAAa,KAAb,CAAmB,IAAnB,CAAwB,GAAxB;;gBAGtCA,IAAI;gBACJ,OAAO,KAAA,GAAM,IAAA,CAAK,IAAL,CAAU,OAAO;oBAC7BA,IAAI;oBACJ,IAAI,OAAO,OAAP,KAAiB,YAAY;wBAChC,KAAA,GAAQ,OAAA,CAAQ,KAAR,CAAc,MAAM;wBAC5B,IAAI,KAAA,IAAO;8BAAM,KAAA,GAAQ;2BAErB;wBACJ,YAAA,GAAe;wBACf,KAAA,GAAQ,OAAA,CAAQ,OAAR,CAAgB,WAAW;;oBAEpC,GAAA,CAAI,SAAJ,CAAc,KAAA,CAAM,OAAO,KAAA,CAAM,KAAN,GAAc,KAAA,CAAM,EAAN,CAAS,QAAQ;;;YAI5D,OAAO;gBACN,MAAM,GAAA,CAAI,QAAJ,EADA;gBAEN,KAAK,SAAA,KAAY,KAAZ,GAAoB,OAAO,GAAA,CAAI,WAAJ,CAAgB;oBAAE,OAAO;;;;;;;;;;;;;"}